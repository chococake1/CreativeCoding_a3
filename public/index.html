<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Symphony with Squares</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        #canvas {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            display: none; /* Hide the canvas initially */
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Create Your Symphony</h1>
        <div id="questions">
            <div class="question">
                <p>1. Choose a mood:</p>
                <button class="answer" data-sound1="sound1.mp3" data-sound2="sound2.mp3" data-sound3="sound3.mp3" data-property="color" data-value="red">Happy</button>
                <button class="answer" data-sound1="sound4.mp3" data-sound2="sound5.mp3" data-sound3="sound6.mp3" data-property="color" data-value="blue">Sad</button>
                <button class="answer" data-sound1="sound7.mp3" data-sound2="sound8.mp3" data-sound3="sound9.mp3" data-property="color" data-value="green">Excited</button>
            </div>
            <div class="question">
                <p>2. Choose an instrument:</p>
                <button class="answer" data-sound1="sound10.mp3" data-sound2="sound11.mp3" data-sound3="sound12.mp3" data-property="size" data-value="300">Piano</button>
                <button class="answer" data-sound1="sound13.mp3" data-sound2="sound14.mp3" data-sound3="sound15.mp3" data-property="size" data-value="240">Guitar</button>
                <button class="answer" data-sound1="sound16.mp3" data-sound2="sound17.mp3" data-sound3="sound18.mp3" data-property="size" data-value="180">Violin</button>
            </div>
            <div class="question">
                <p>3. How tired are you?</p>
                <button class="answer" data-sound1="sound19.mp3" data-sound2="sound20.mp3" data-sound3="sound21.mp3" data-property="squares" data-value="1">Not tired at all</button>
                <button class="answer" data-sound1="sound22.mp3" data-sound2="sound23.mp3" data-sound3="sound24.mp3" data-property="squares" data-value="2">A little tired</button>
                <button class="answer" data-sound1="sound25.mp3" data-sound2="sound26.mp3" data-sound3="sound27.mp3" data-property="squares" data-value="3">Exhausted</button>
            </div>
        </div>
        <div id="controls" style="display: none;">
            <button id="playSymphony">Play Symphony</button>
            <button id="stopSymphony">Stop Symphony</button>
        </div>
    </div>

    <canvas id="canvas"></canvas>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const questions = document.querySelectorAll('.question');
            const playSymphonyButton = document.getElementById('playSymphony');
            const stopSymphonyButton = document.getElementById('stopSymphony');
            const canvas = document.getElementById('canvas');
            const ctx = canvas.getContext('2d');
            let currentQuestion = 0;
            let isRunning = false; // Boolean variable to control animation

            // Default square properties
            let squareProperties = {
                color: 'black',
                size: 240,
                speed: 8
            };

            // Show the first question
            questions[currentQuestion].style.display = 'block';

            document.querySelectorAll('.answer').forEach(button => {
                button.addEventListener('click', event => {
                    // Update square properties based on user's choice
                    const property = event.target.getAttribute('data-property');
                    const value = event.target.getAttribute('data-value');
                    if (property && value) {
                        if (property === 'size' || property === 'speed') {
                            squareProperties[property] = parseFloat(value);
                        } else {
                            squareProperties[property] = value;
                        }
                    }

                    // Hide the current question
                    questions[currentQuestion].style.display = 'none';

                    // Show the next question if available
                    currentQuestion++;
                    if (currentQuestion < questions.length) {
                        questions[currentQuestion].style.display = 'block';
                    } else {
                        document.getElementById('controls').style.display = 'block';
                        canvas.style.display = 'block'; // Show the canvas
                        isRunning = true; // Start square animation
                        animate(); // Start animation loop
                    }
                });
            });

            playSymphonyButton.addEventListener('click', () => {
                isRunning = true; // Resume square animation
                animate(); // Continue animation loop
            });

            stopSymphonyButton.addEventListener('click', () => {
                isRunning = false; // Pause square animation
                // Stop all sounds
                const sounds = document.querySelectorAll('audio');
                sounds.forEach(sound => {
                    sound.pause();
                    sound.currentTime = 0;
                });
            });

            // Set canvas width and height to fill the window
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            // Square properties
            let squareX = Math.random() * (canvas.width - squareProperties.size); // Random starting x position
            let squareY = Math.random() * (canvas.height - squareProperties.size); // Random starting y position
            let dx = squareProperties.speed * 0.67; // Slow down by about 1/3
            let dy = squareProperties.speed * 0.67; // Slow down by about 1/3

            // Color change interval
            const colorChangeInterval = 12; // Change the color every 12 frames to slow down the animation
            let frameCount = 0;

            // Function to generate a random color
            function randomColor() {
                return '#' + Math.floor(Math.random() * 16777215).toString(16);
            }

            // Function to draw a square on the canvas
            function drawSquare(x, y, size, color) {
                ctx.fillStyle = color; // Set fill color
                ctx.fillRect(x, y, size, size); // Draw filled rectangle
            }

            // Function to play a sound
            function playRandomSound(button) {
                const soundIndex = Math.floor(Math.random() * 3) + 1; // Generate a random index between 1 and 3
                const soundSrc = button.getAttribute(`data-sound${soundIndex}`);
                const sound = new Audio(soundSrc);
                sound.play();
            }

            // Function to animate the square
            function animate() {
                if (!isRunning) return; // Check if animation is paused

                frameCount++; // Increment frame count

                // Move the square diagonally
                squareX += dx; // Move horizontally
                squareY += dy; // Move vertically

                // Bounce off the edges if the square hits the canvas boundaries
                if (squareX + squareProperties.size > canvas.width || squareX < 0) {
                    dx = -dx; // Reverse horizontal direction
                }
                if (squareY + squareProperties.size > canvas.height || squareY < 0) {
                    dy = -dy; // Reverse vertical direction
                }

                // Clear canvas before drawing the next frame
                ctx.clearRect(0, 0, canvas.width, canvas.height);

                // Draw the square
                drawSquare(squareX, squareY, squareProperties.size, squareProperties.color);

                // Request next animation frame to continue animation loop
                requestAnimationFrame(animate);
            }
        });
    </script>
</body>
</html>
